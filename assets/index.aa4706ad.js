var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;import{r as a,R as o,a as c}from"./vendor.2786b42d.js";let i=0;class u{constructor(e,t){this.id=e,this.componentDatas=t}getDataFor(e){var t;return null==(t=this.componentDatas.find((t=>t.component.id===e.id)))?void 0:t.data}}class l{constructor(){this.resources={}}createEntity(e){const t=function(e){const t=i;return i+=1,new u(t,e)}(e);return this.resources[t.id]=t,t}}let d=0;class p{constructor(){this.Data=void 0,this.id=d,d+=1}create(e){return{component:this,data:e}}serialize(e){return JSON.stringify(e)}deserialize(e){return this.validate(JSON.parse(e))}}const h=class extends p{constructor(){super()}validate(e){if("number"==typeof e)return e;throw new Error(`Expected Number but ${e} received.`)}};let y=h;y.INSTANCE=new h;const w=class extends p{constructor(){super()}validate(e){if("string"==typeof e)return e;throw new Error(`Expected String but ${e} received.`)}};w.INSTANCE=new w;const x=class extends p{constructor(){super()}validate(e){if("boolean"==typeof e)return e;throw new Error(`Expected Boolean but ${e} received.`)}};x.INSTANCE=new x;class f extends p{constructor(e){super(),this.schema=e}validate(e){if("object"!=typeof e||!e)throw new Error(`Expected Array but ${e} received.`);const a={},o=((e,a)=>{for(var o in a||(a={}))r.call(a,o)&&s(e,o,a[o]);if(t)for(var o of t(a))n.call(a,o)&&s(e,o,a[o]);return e})({},this.schema);for(const t of Object.keys(e)){if(!(t in o))throw new Error(`Unexpected key ${t}`);a[t]=o[t].validate(e[t]),delete o[t]}const c=Object.keys(o);if(c.length>0)throw new Error(`Expected ${c.join(", ")}, but neither accepted.`);return a}}function m(e){return new f(e)}function b(){return y.INSTANCE}function v(e,t){return new class extends class{constructor(e){this.data=e}runNow(e){for(const t of Object.values(e.resources)){const e=this.data.map((e=>t.getDataFor(e)));e.every((e=>e))&&this.run(e)}}}{constructor(){super(e)}setup(){}run(e){t(...e)}dispose(){}}}class E{constructor(e){this.systems=e}setup(e){for(const t of this.systems)t.setup(e)}dispatch(e){for(const t of this.systems)t.runNow(e)}}const k=m({x:b(),y:b()}),M=m({x:b(),y:b()}),N=v([k,M],((e,t)=>{const r=Math.min(window.innerWidth,window.innerHeight);e.x=Math.max(0,Math.min(r-48,e.x+t.x)),e.y=Math.max(0,Math.min(r-48,e.y+t.y))})),g=v([M],(e=>{e.x=Math.max(0,Math.abs(e.x)-4)*Math.sign(e.x),e.y=Math.max(0,Math.abs(e.y)-4)*Math.sign(e.y)})),S=v([k,M],((e,t)=>{const r=Math.min(window.innerWidth,window.innerHeight);t.x+=2*Math.atan((r/2-(e.x+24))/4),t.y+=2*Math.atan((r/2-(e.y+24))/4)}));function O(){const[e,t]=a.exports.useState(null),[r,n]=a.exports.useState(null),[s,c]=a.exports.useState(null),[i,u]=a.exports.useState(0),d=a.exports.useRef({w:!1,a:!1,s:!1,d:!1});a.exports.useEffect((()=>{const e=new l;t(e);const r=e.createEntity([k.create({x:0,y:0}),M.create({x:0,y:0})]);c(r);const s=new E([N,g,S]);s.setup(e),n(s)}),[]);const p=a.exports.useCallback(((e,t)=>{const r=null==s?void 0:s.getDataFor(M);r&&(r.x=r.x+e,r.y=r.y+t)}),[s]),h=a.exports.useCallback((()=>{d.current.w&&p(0,-6),d.current.a&&p(-6,0),d.current.s&&p(0,6),d.current.d&&p(6,0)}),[d.current,p]),y=a.exports.useCallback((e=>{switch(e.key){case"w":d.current.w=!0;break;case"a":d.current.a=!0;break;case"s":d.current.s=!0;break;case"d":d.current.d=!0}}),[]),w=a.exports.useCallback((e=>{switch(e.key){case"w":d.current.w=!1;break;case"a":d.current.a=!1;break;case"s":d.current.s=!1;break;case"d":d.current.d=!1}}),[]);return a.exports.useEffect((()=>{const t=setInterval((()=>{null!==e&&null!==r&&(h(),r.dispatch(e),u((e=>e+1)))}),1e3/60);return()=>clearInterval(t)}),[e,r]),o.createElement("div",{className:"App",tabIndex:0,onKeyDown:y,onKeyUp:w},o.createElement("div",{className:"me",style:{left:null==s?void 0:s.componentDatas[0].data.x,top:null==s?void 0:s.componentDatas[0].data.y}}))}c.render(o.createElement(o.StrictMode,null,o.createElement(O,null)),document.getElementById("root"));
