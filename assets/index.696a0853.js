var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;import{r as s,R as c,a}from"./vendor.2786b42d.js";let u=0;class i{constructor(e,t){this.id=e,this.dataArray=t}getDataFor(e){var t;return null==(t=this.dataArray.find((t=>t.component.id===e.id)))?void 0:t.data}}class l{constructor(){this.resources={}}createEntity(e){const t=function(e){const t=u;return u+=1,new i(t,e)}(e);return this.resources[t.id]=t,t}}class d{constructor(e){this.systems=e}setup(e){for(const t of this.systems)t.setup(e)}dispatch(e){for(const t of this.systems)t.runNow(e)}}const p=class{constructor(){this.Data=void 0,this.id=p.GlobalComponentId,p.GlobalComponentId+=1}create(e){return{component:this,data:e}}serialize(e){return JSON.stringify(e)}deserialize(e){return this.validate(JSON.parse(e))}};let y=p;y.GlobalComponentId=0;const f=class extends y{constructor(){super()}validate(e){if("number"==typeof e)return e;throw new Error(`Expected Number but ${e} received.`)}};let h=f;function m(){return h.INSTANCE}h.INSTANCE=new f;const v=class extends y{constructor(){super()}validate(e){if("string"==typeof e)return e;throw new Error(`Expected String but ${e} received.`)}};v.INSTANCE=new v;const x=class extends y{constructor(){super()}validate(e){if("boolean"==typeof e)return e;throw new Error(`Expected Boolean but ${e} received.`)}};x.INSTANCE=new x;class w extends y{constructor(e){super(),this.schema=e}validate(e){if("object"!=typeof e||!e)throw new Error(`Expected Array but ${e} received.`);const s={},c=((e,s)=>{for(var c in s||(s={}))r.call(s,c)&&o(e,c,s[c]);if(t)for(var c of t(s))n.call(s,c)&&o(e,c,s[c]);return e})({},this.schema);for(const t of Object.keys(e)){if(!(t in c))throw new Error(`Unexpected key ${t}`);s[t]=c[t].validate(e[t]),delete c[t]}const a=Object.keys(c);if(a.length>0)throw new Error(`Expected ${a.join(", ")}, but neither accepted.`);return s}}function b(e){return new w(e)}const E=b({x:m(),y:m()}),g=b({x:m(),y:m()});function N(e,t){return new class extends class{constructor(e){this.componentArray=e}runNow(e){for(const t of Object.values(e.resources)){const e=this.componentArray.map((e=>t.getDataFor(e)));e.every((e=>e))&&this.run(e)}}}{constructor(){super(e)}setup(){}run(e){t(...e)}dispose(){}}}function O(){return Math.min(window.innerWidth,window.innerHeight)}function S(e,t,r){return e<t?t:r<e?r:e}const j=N([E,g],((e,t)=>{e.x=S(e.x+t.x,0,O()-48),e.y=S(e.y+t.y,0,O()-48)}));function I(e,t){const r=e+-Math.sign(e)*t;return Math.sign(e)!=Math.sign(r)?0:r}const k=N([g],(e=>{e.x=I(e.x,4),e.y=I(e.y,4)})),C=N([E,g],((e,t)=>{const r=O()/2-24;t.x+=2*Math.atan((r-e.x)/4),t.y+=2*Math.atan((r-e.y)/4)}));function D(){var e,t;const[r,n]=s.exports.useState(null),[o,a]=s.exports.useState(null),[u,i]=s.exports.useState(null),[p,y]=s.exports.useState(0),{keypress:f,handleKeyDown:h,handleKeyUp:m}=function(e){const t=s.exports.useRef(Object.fromEntries(Object.values(e).map((e=>[e,!1])))),r=s.exports.useCallback((r=>{const n=e[r.key];n&&(t.current[n]=!0)}),[]),n=s.exports.useCallback((r=>{const n=e[r.key];n&&(t.current[n]=!1)}),[]);return{keypress:t,handleKeyDown:r,handleKeyUp:n}}({w:"moveUp",a:"moveLeft",s:"moveDown",d:"moveRight"});s.exports.useEffect((()=>{const e=new l;n(e);const t=e.createEntity([E.create({x:0,y:0}),g.create({x:0,y:0})]);i(t);const r=new d([j,k,C]);r.setup(e),a(r)}),[]);const v=s.exports.useCallback(((e,t)=>{const r=null==u?void 0:u.getDataFor(g);r&&(r.x+=e,r.y+=t)}),[u]),x=s.exports.useCallback((()=>{f.current.moveUp&&v(0,-6),f.current.moveLeft&&v(-6,0),f.current.moveDown&&v(0,6),f.current.moveRight&&v(6,0)}),[f.current,v]);return s.exports.useEffect((()=>{const e=setInterval((()=>{null!==r&&null!==o&&(x(),o.dispatch(r),y((e=>e+1)))}),1e3/60);return()=>clearInterval(e)}),[r,o]),c.createElement("div",{className:"App",tabIndex:0,onKeyDown:h,onKeyUp:m},c.createElement("div",{className:"me",style:{left:null==(e=null==u?void 0:u.getDataFor(E))?void 0:e.x,top:null==(t=null==u?void 0:u.getDataFor(E))?void 0:t.y}}))}a.render(c.createElement(c.StrictMode,null,c.createElement(D,null)),document.getElementById("root"));
